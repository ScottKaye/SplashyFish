var splashyfish=function(e){function t(e){this.direction=S++%2===0?"up":"down",this.length=e,this.x=x}function n(){setTimeout(function(){if(w){var e=f(0,g-b);P.push(new t(e)),P.push(new t(g-e-b))}n()},E)}function l(){w=!0,n(),I.image=document.createElement("img"),I.image.src="img/sprites.png",I.image.style.display="none",document.body.appendChild(I.image)}function o(){w&&(I.angle=I.yVel,I.yVel=8,r("jump.mp3"),v=!1)}function a(){P=[],V=0,w=!0,I.yVel=0,I.y=g/2,I.x=x/4,T=[{x:I.x,y:I.y}],v=!1}function f(e,t){return Math.floor(Math.random()*(t-e+1))+e}function c(e,t,i,n){var l=m.fillStyle;m.beginPath(),m.arc(e,t,i,0,2*Math.PI,!1),m.fillStyle=n,m.fill(),m.fillStyle=l}function d(e,t,i,n){var l=m.fillStyle;m.fillStyle=n,m.font="24px 'Press Start 2P'",m.fillText(e,t,i),m.fillStyle=l}function y(e,t){var i=2*I.yVel,n=I.wings?0:240;m.translate(e,t),m.rotate(i*Math.PI/180),m.drawImage(I.image,n,0,240,240,-16,-16,32,32),m.rotate(-i*Math.PI/180),m.translate(-e,-t)}function r(e){var t=document.createElement("audio"),i=document.createElement("source");i.type="audio/mpeg",i.src="snd/"+e,t.appendChild(i),document.body.appendChild(t),t.volume=.5,t.play(),setTimeout(function(){document.body.removeChild(t)},800)}var e=document.getElementById(e);e.width=window.innerWidth,e.height=400;var u,s,h,m=e.getContext("2d"),x=e.width,g=e.height,p=50,w=!0,v=!1,S=0,b=200,E=1e3,V=0,I={x:x/4,y:g/2,yVel:0,image:null,wings:!0,speed:5},P=[],T=[{x:I.x,y:I.y}];setInterval(function(){I.wings=!I.wings},100),setInterval(function(){T.push({x:I.x,y:I.y})},25),l(),e.addEventListener("mousedown",function(e){1===e.which?o():2===e.which&&(T=[{x:I.x,y:I.y}],w=!0,v=!0)},!1),window.addEventListener("keydown",function(e){32===e.which&&o(),13===e.which&&a()},!1),e.addEventListener("mousemove",function(e){u=e.x,s=e.y},!1),function k(){if(requestAnimationFrame(k),w){m.fillStyle="black",m.fillRect(0,0,x,g),y(I.x,I.y);var e=I.y-16,t=I.y+16,n=I.x+16,l=I.x-16;if(v){for(m.beginPath(),m.moveTo(T[0].x,T[0].y),i=0;i<T.length-2;i++)if(T[i].x<=-10)T.splice(T.indexOf(T[i]),1);else{var o=(T[i].x+T[i+1].x)/2,a=(T[i].y+T[i+1].y)/2;m.lineTo(T[i].x,T[i].y,o,a),T[i].x-=I.speed}m.lineWidth=3,m.strokeStyle="#ff0000",m.stroke()}P.forEach(function(i){if(i.x>=0-p){var o;switch(i.direction){default:case"up":o=g-i.length,m.fillStyle="red";break;case"down":o=0,m.fillStyle="blue"}m.fillRect(i.x,o,p,i.length),n>=i.x&&l<i.x+p&&(clearTimeout(h),h=setTimeout(function(){V++},100),("down"===i.direction&&e<=i.length||"up"===i.direction&&t>=g-i.length)&&(w=!1)),i.x-=I.speed}}),d(V,x-64,64,"#ffffff"),v&&(c(I.x,e,2,"yellow"),c(I.x,t,2,"cyan"),c(l,I.y,2,"pink"),c(n,I.y,2,"lime")),v?(I.x=u,I.y=s):(I.y+=I.yVel,I.yVel=I.yVel/.981-.5),(0>=e||t>=g)&&(w=!1)}}()};