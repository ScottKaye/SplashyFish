var splashyfish=function(e){function t(e){this.direction=S++%2===0?"up":"down",this.length=e,this.x=m}function n(){setTimeout(function(){if(p){var e=f(0,g-E);T.push(new t(e)),T.push(new t(g-e-E))}n()},I)}function l(){p=!0,n(),V.image=document.createElement("img"),V.image.src="img/sprites.png",V.image.style.display="none",document.body.appendChild(V.image)}function o(){p&&(V.yVel=8,c("jump.mp3"),v=!1)}function a(){T=[],P=0,p=!0,V.yVel=0,V.y=g/2,V.x=m/4,b=[{x:V.x,y:V.y}],v=!1}function f(e,t){return Math.floor(Math.random()*(t-e+1))+e}function r(e,t,i,n){var l=x.fillStyle;x.beginPath(),x.arc(e,t,i,0,2*Math.PI,!1),x.fillStyle=n,x.fill(),x.fillStyle=l}function d(e,t,i,n){var l=x.fillStyle;x.fillStyle=n,x.font="24px 'Press Start 2P'",x.fillText(e,t,i),x.fillStyle=l}function y(e,t){var i=2*V.yVel,n=V.wings?0:240;x.translate(e,t),x.rotate(i*Math.PI/180),x.drawImage(V.image,n,0,240,240,-16,-16,32,32),x.rotate(-i*Math.PI/180),x.translate(-e,-t)}function c(e){var t="snd/"+e,i=new Audio(t);i.addEventListener("loadedmetadata",function(){i.play()},!1)}var e=document.getElementById(e);e.width=window.innerWidth,e.height=400;var s,u,h,x=e.getContext("2d"),m=e.width,g=e.height,w=50,p=!0,v=!1,S=0,E=200,I=1e3,P=0,V={x:m/4,y:g/2,yVel:0,image:null,wings:!0,speed:5},T=[],b=[{x:V.x,y:V.y}];setInterval(function(){V.wings=!V.wings},100),setInterval(function(){v&&b.push({x:V.x,y:V.y})},25),l(),e.addEventListener("mousedown",function(e){1===e.which?o():2===e.which&&(b=[{x:V.x,y:V.y}],p=!0,v=!0)},!1),window.addEventListener("keydown",function(e){32===e.which&&o(),13===e.which&&a()},!1),e.addEventListener("mousemove",function(e){s=e.x,u=e.y},!1),function k(){if(requestAnimationFrame(k),p){var e=x.createLinearGradient(0,0,0,g);e.addColorStop(0,"#2980b9"),e.addColorStop(1,"#34495e"),x.fillStyle=e,x.fillRect(0,0,m,g),y(V.x,V.y);var t=V.y-16,n=V.y+16,l=V.x+16,o=V.x-16;if(v){for(x.beginPath(),x.moveTo(b[0].x,b[0].y),i=0;i<b.length-2;i++)if(b[i].x<=-10)b.splice(b.indexOf(b[i]),1);else{var a=(b[i].x+b[i+1].x)/2,f=(b[i].y+b[i+1].y)/2;x.lineTo(b[i].x,b[i].y,a,f),b[i].x-=V.speed}x.lineWidth=3,x.strokeStyle="#ff0000",x.stroke()}x.fillStyle="#27ae60",T.forEach(function(e){if(e.x>=0-w){var i;switch(e.direction){default:case"up":i=g-e.length;break;case"down":i=0}x.fillRect(e.x,i,w,e.length),l>=e.x&&o<e.x+w&&(clearTimeout(h),h=setTimeout(function(){P++},100),("down"===e.direction&&t<=e.length||"up"===e.direction&&n>=g-e.length)&&(p=!1)),e.x-=V.speed}}),d(P,m-64,64,"#ffffff"),v&&(r(V.x,t,2,"yellow"),r(V.x,n,2,"cyan"),r(o,V.y,2,"pink"),r(l,V.y,2,"lime")),v?(V.x=s,V.y=u):(V.y+=V.yVel,V.yVel=V.yVel/.981-.5),(0>=t||n>=g)&&(p=!1)}}()};